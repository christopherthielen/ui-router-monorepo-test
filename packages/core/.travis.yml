language: node_js
node_js: 8.9.1
before_install: yarn global add greenkeeper-lockfile@1 yalc
install: yarn --check-files
before_script: greenkeeper-lockfile-update && greenkeeper-lockfile-upload
script:
- if [ "x${DOWNSTREAM_PKGS}x" != "xx" ] ; then npm run test:downstream ; else tsc
  && npm test ; fi
env:
  global:
    secure: bEGHePu9rkjcy5Pq3RQQfCIRzAfCSxH7dZsdOJd3pAXEGbkhuCOAGFV0v+NVbRBWNYv0yIExwwu2VOVfAPGqmmuhzE8Uq/WZeLWUbUA1oSIN7t9IkYRKIdoE36o85eyRxSTP6w3dtMHXLeMvPbgtgEUVrgPztBVe3ySoQ+nA3jbgZ/fBpuEevJ2dAxwybbtRwZBflplUumpwmy1pSiLHptdFXsxmmLr0hOjx+WZd38jMZo4H4vV9zo6wz34hjf+j1f0jsjmsKgpRVPLADtLTcqIfEegSG7vLmlFJLGBtBZ6UhIioZseZTVOi2wq1hK0E+3SzPJVXhu3h7VsIBVgCaaYJQ07p7q9LszwWwxHHzePLBtV77J6mJ1zZFbS/PHmVHnfU/gz5+l2Te2KSkvFYbq9uVXd4CLLeR1xdECwX8qiXMtUOk7IauVVzFtLCPRVksmEjClJNf1tAi+j9nKezYHQ8LPSqTyoxo/0PhQJ0U3pCQuKGTxO9lDi63Gks9lr87N+yrn81W+2wbGKL6iqItKPAQ5Tcl5FbhmwUk40p0Sz1KNjBWepREQAeCgRKFN4y/Xhi6Mn1TydwE9zHXdfIiWNYaxl0LjXMnAMahvO2+m5NClDWhzBii21JsdMyUS3TUFGyVIfok2M+uaM2NZn7GLNRSOGarBpLhF/5lci/9kY=
  matrix:
  - DOWNSTREAM_PKGS=
  - DOWNSTREAM_PKGS=typescript2.2,typescript2.3,typescript2.4,typescript2.5,typescript2.6
  - DOWNSTREAM_PKGS=angular,sample-app-angular
  - DOWNSTREAM_PKGS=angularjs,sample-app-angularjs
  - DOWNSTREAM_PKGS=react
  - DOWNSTREAM_PKGS=react,sample-app-react
matrix:
  fast_finish: true
  allow_failures:
  - env: DOWNSTREAM_PKGS=react,sample-app-react
  - env: DOWNSTREAM_PKGS=angular,sample-app-angular
  - env: DOWNSTREAM_PKGS=angularjs,sample-app-angularjs
  - env: DOWNSTREAM_PKGS=react
  - env: DOWNSTREAM_PKGS=react,sample-app-react
notifications:
  slack:
    on_success: change
    rooms:
      secure: YXAdbpNslKfzMVgby/amCLSJqsQ1ZUYnWzG6MJTIt7/UyMjbyasqknefSV2yFGdbWXCIkyh1ClTArFRxGfzJA9YKadWuueWJ64cOusz6fsY4G1iAFeDWGa4kOffVntk9f4ZXgkeP4Hk1Bce3iPXMIFXy3R10LLvBb3BcBge5ynPJm+arIDtKoMR6yXqz7Jj0ZOn1oBNV8SgyQHEvs6eBggGnPJubmUd1HVfQ/PXvJXk6szlD4mlcNgUnBhxy0zA0AG1TPKidk+fyLC0YjqR/2GfUQIcnhfOTQhJfKy6UOTIYQQPYSrTSHX8rS7H8T+7ZSTu5nCCiVjVP3CNjEIUF57exdT4wjWQv+gpTYesUEgkaf0200YCzwZez0l2pSpAZhKi2cyzmanO36xUHeqR3bdaDyFPDTkd2z4ZiyO/MXkIWpU5ktepHvx5UtD/rRaFQ4u6wchVxfJBB2Wr8FbW1rOZtdn5y7mQCU90JzSZvF9d19zjF2bOTHqsqh8YtPAlGcQb1c9O1mQkSYWklSRTO/68Os59fUbrat9lQvqMnT8/pV275lCDu7xCSEKY1ORfgzgmD2CditdeC15haP4n8eOoToE8dj3rzCcMRtHBGe9wqIKb97aSO4wJzY6NDN5U/2p1/PtPKwcSk75N/aPFrCbwe5jUezHMe7hJfqevYX1A=
sudo: false
git:
  depth: 3
cache:
  yarn: true
  directories:
  - node_modules
  - ".downstream_cache"
